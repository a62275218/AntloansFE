<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>conditional approval</title>
    <!--my css-->
    <link rel="stylesheet" href="../styles/conditional-approval.css">
</head>

<body>
<nav class="nav_bar" ng-include="'views/partials/navigation.html'">
</nav>

<div class='main'>

    <aside class="left_bar" data-status='open' ng-include="'views/partials/sidebar.html'">
    </aside>

    <div class="right_part">
      <div class="width_fix">

        <div class="approval_up">
            <span id="jobEditBtn" ng-click="jobEdit()"><i class="fa fa-pencil-square-o fa-2x"
                                                          aria-hidden="true"></i></span>
            <label for="">Client</label>
            <hr>
            <table class="job_show">
                <tr>
                    <th>first name</th>
                    <td><input type="text" class="disable" ng-model="job.first_name" disabled="disabled"></td>
                    <th>last name</th>
                    <td><input type="text" class="disable" ng-model="job.last_name" disabled></td>
                </tr>
                <tr>
                    <th>mobile</th>
                    <td><input type="text" class="disable" ng-model="job.mobile" disabled></td>
                    <th>phone</th>
                    <td><input type="text" class="disable" ng-model="job.phone" disabled></td>
                </tr>
                <tr>
                    <th>email</th>
                    <td><input type="text" class="disable" ng-model="job.email" disabled></td>
                    <th>security address</th>
                    <td><input type="text" class="disable" ng-model="job.address" disabled></td>
                </tr>
                <tr>
                    <th>prefered time</th>
                    <td><input type="text" class="disable" ng-model="job.preferred_time" disabled></td>
                    <th>prefered method</th>
                    <td><input type="text" class="disable" ng-model="job.preferred_method" disabled></td>
                </tr>
            </table>
            <label for="">Loan</label>
            <hr>
            <table class="loan_show">
                <tr>
                  <th>status</th>
                  <td><input type="text" class="disable" ng-model="job.deal_status.label" disabled></td>
                  <th>loan amount</th>
                  <td><input type="text" class="disable" disabled>{{job.loan_amount|currency}}</td>
                </tr>
                <tr>
                  <th>assign</th>
                  <td><input type="text" class="disable" ng-model="job.preferred_time" disabled></td>
                  <th>loan purpose</th>
                  <td><input type="text" class="disable" ng-model="job.loan_purpose.label" disabled></td>
                </tr>
                <tr>
                  <th>broke</th>
                  <td><input style="display:inline-block; width:45%;" type="text" class="disable" ng-model="job.broker.first_name" disabled>
                      <input style="display:inline-block; width:45%;" type="text" class="disable" ng-model="job.broker.last_name" disabled>
                  </td>


                </tr>
                <tr>
                  <th>repayment type</th>
                  <td><input type="text" class="disable" ng-model="job.repayment_type.label" disabled></td>
                  <th>file nature</th>
                  <td><input type="text" class="disable" ng-model="job.file_nature.label" disabled></td>
                </tr>
                <tr>
                  <th>special notes</th>
                  <td colspan="3"><input class="disable special_note" type="text" ng-model="job.special_note" disabled></td>
                </tr>
            </table>


            <button class="saveBtn01" type="button" name="button" ng-click="updateUser()">Save</button>
        </div>

        <div class="approval_middle">
            <div class="user_contact">
                <div class="contact_up">
                    <img ng-if="job.broker.avatar" ng-src="{{job.broker.avatar}}" alt="">
                    <img ng-if="!job.broker.avatar" ng-src="{{default_img_url}}" alt="">
                    <div class="user_intro">
                        <h4>{{job.broker.first_name}} {{job.broker.last_name}}</h4>
                        <p>{{job.broker.address}}</p>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="contact_down">
                    <span><i class="fa fa-phone fa-lg" aria-hidden="true"></i>&nbsp;&nbsp;
                      <a href="tel:{{job.broker.phone || job.broker.mobile}}">{{job.broker.phone || job.broker.mobile || 'no phone number now'}}</a></span> <br>
                    <span><i class="fa fa-envelope-o fa-lg" aria-hidden="true"></i>&nbsp;&nbsp;
                      <a href="mailto:{{job.broker.email}}">{{job.broker.email}}</a></span>
                </div>
                <div class="clear"></div>
            </div>

            <div class="user_contact ">
                <span class="user_plus" ng-if="selection[0] == 'origin'" ng-click="showUser(0)">
                    <i class="fa fa-plus-circle fa-4x" aria-hidden="true"></i>
                </span>
                <div class="clear"></div>

                <ui-select ng-model="user[0].selected" class="select_input selectpicker select_page"
                           ng-if="selection[0] == 'select'"
                           on-select="showUserInfo(0,'admin',user[0].selected.user_id)">
                    <ui-select-match>
                        <span ng-bind="$select.selected.first_name +' '+$select.selected.last_name"></span>
                    </ui-select-match>
                    <ui-select-choices
                            repeat="item in admins | propsFilter:{first_name:$select.search,last_name:$select.search,role:$select.search} track by $index">
                        <strong><span ng-bind="item.first_name"></span> <span ng-bind="item.last_name"></span></strong><br>
                        <span ng-bind="item.role"></span>
                    </ui-select-choices>
                </ui-select>
                <div class="contact_up" ng-if="selection[0] == 'selected'">
                    <img ng-if="user[0].selected.avatar" ng-src="{{user[0].selected.avatar}}" alt="">
                    <img ng-if="!user[0].selected.avatar" ng-src="{{default_img_url}}" alt="">
                    <div class="user_intro">
                        <h4>{{user[0].selected.first_name}} {{user[0].selected.last_name}}</h4>
                        <p>{{user[0].selected.address}}</p>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="contact_down" ng-if="selection[0] == 'selected'">
                    <span><i class="fa fa-phone fa-lg" aria-hidden="true"></i>&nbsp; {{user[0].selected.phone || user[0].selected.mobile || 'no phone number now'}}</span>
                    <span><i class="fa fa-envelope-o fa-lg" aria-hidden="true"></i>&nbsp; <a
                            href="mailto:{{user[0].selected.email}}">{{user[0].selected.email || 'no email now'}}</a></span>
                </div>
                <div class="contact_up" ng-if="selection[0] == 'settled'">
                    <img ng-if="job.admin.avatar" ng-src="{{job.admin.avatar}}" alt="">
                    <img ng-if="!job.admin.avatar" ng-src="{{default_img_url}}" alt="">
                    <div class="user_intro">
                        <h4>{{job.admin.first_name}} {{job.admin.last_name}}</h4>
                        <p>{{job.admin.address}}</p>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="contact_down" ng-if="selection[0] == 'settled'">
                    <span><i class="fa fa-phone fa-lg" aria-hidden="true"></i>&nbsp; {{job.admin.phone || job.admin.mobile || 'no phone number now'}}</span>
                    <span><i class="fa fa-envelope-o fa-lg" aria-hidden="true"></i>&nbsp; <a
                            href="mailto:{{job.admin.email}}">{{job.admin.email || 'no email now'}}</a></span>
                </div>
                <div class="clear"></div>
            </div>

            <div class="user_contact ">
                <span class="user_plus" ng-if="selection[1] == 'origin'" ng-click="showUser(1)">
                    <i class="fa fa-plus-circle fa-4x" aria-hidden="true"></i>
                </span>
                <div class="clear"></div>

                <ui-select ng-model="user[1].selected" class="select_input selectpicker select_page"
                           ng-if="selection[1] == 'select'"
                           on-select="showUserInfo(1,'supervisor',user[1].selected.user_id)">
                    <ui-select-match>
                        <span ng-bind="$select.selected.first_name +' '+$select.selected.last_name"></span>
                    </ui-select-match>
                    <ui-select-choices
                            repeat="item in supervisors | propsFilter:{first_name:$select.search,last_name:$select.search,role:$select.search} track by $index">
                        <strong><span ng-bind="item.first_name"></span> <span ng-bind="item.last_name"></span></strong><br>
                        <span ng-bind="item.role"></span>
                    </ui-select-choices>
                </ui-select>
                <div class="contact_up" ng-if="selection[1] == 'selected'">
                    <img ng-if="user[1].selected.avatar" ng-src="{{user[1].selected.avatar}}" alt="">
                    <img ng-if="!user[1].selected.avatar" ng-src="{{default_img_url}}" alt="">
                    <div class="user_intro">
                        <h4>{{user[1].selected.first_name}} {{user[1].selected.last_name}}</h4>
                        <p>{{user[1].selected.address}}</p>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="contact_down" ng-if="selection[1] == 'selected'">
                    <span><i class="fa fa-phone fa-lg" aria-hidden="true"></i>&nbsp;&nbsp;
                      <a href="tel:{{user[1].phone || user[1].selected.mobile}}">{{user[1].phone || user[1].mobile || 'no phone number now'}}</a></span> <br>
                    <span><i class="fa fa-envelope-o fa-lg" aria-hidden="true"></i>&nbsp;&nbsp;
                      <a href="mailto:{{user[1].email}}">{{user[1].email || 'no email now'}}</a></span>
                </div>
                <div class="contact_up" ng-if="selection[1] == 'settled'">
                    <img ng-if="job.supervisor.avatar" ng-src="{{job.supervisor.avatar}}" alt="">
                    <img ng-if="!job.supervisor.avatar" ng-src="{{default_img_url}}" alt="">
                    <div class="user_intro">
                        <h4>{{job.supervisor.first_name}} {{job.supervisor.last_name}}</h4>
                        <p>{{job.supervisor.address}}</p>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="contact_down" ng-if="selection[1] == 'settled'">
                    <span><i class="fa fa-phone fa-lg" aria-hidden="true"></i>&nbsp;&nbsp;
                      <a href="tel:{{job.supervisor.phone || job.supervisor.mobile}}">{{job.supervisor.phone || job.supervisor.mobile || 'no phone number now'}}</a></span> <br>
                    <span><i class="fa fa-envelope-o fa-lg" aria-hidden="true"></i>&nbsp;&nbsp;
                      <a href="mailto:{{job.supervisor.email}}">{{job.supervisor.email || 'no email now'}}</a></span>
                </div>
                <div class="clear"></div>
            </div>

            <div class="clear"></div>
        </div>

        <div class="approval_down">
            <div class="approval_down_left">
                <span class="timeline_editBtn"><i class="fa fa-pencil-square-o fa-2x" aria-hidden="true"></i></span>
                <h3>Conditional Approval</h3>
                <div class="process">
                    <span class='submission'><i class="fa fa-arrow-circle-left fa-3x" aria-hidden="true"></i></span>
                    <span class='assessment'><i class="fa fa-refresh fa-4x" aria-hidden="true"></i></span>
                    <span class='settlement'><i class="fa fa-check-circle fa-3x" aria-hidden="true"></i></span>
                </div>
                <div class="process_name">
                    <span class='submission_name'>SUBMISSION</span>
                    <span class='assessment_name'>ASSESSMENT</span>
                    <span class='settlement_name'>SETTLEMENT</span>
                </div>

                <div class="vertical_progress">
                    <ul class='timeline'>
                        <li class='subm1'>
                            <div class=""></div>
                            <span><strong>SUBMISSION</strong></span></li>
                        <li class='subm2'><span class='time'>{{newStatus[1].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 1" data-index='0'></div>
                            <span class='stage_name'>Interview conducted</span> &nbsp;<span class='num'ng-if="commentAmount[1]" ng-click="showStatusComment(1)">{{commentAmount[1]}}</span>
                        </li>
                        <li class='subm3'><span class='time'>{{newStatus[2].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 2" data-index='1'></div>
                            <span class='stage_name'>Document collected</span> &nbsp;<span class='num'ng-if="commentAmount[2]" ng-click="showStatusComment(2)">{{commentAmount[2]}}</span>
                        </li>
                        <li class='subm4'><span class='time'>{{newStatus[3].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 3" data-index='2'></div>
                            <span class='stage_name'>Application submitted</span> &nbsp;<span class='num'ng-if="commentAmount[3]" ng-click="showStatusComment(3)">{{commentAmount[3]}}</span>
                        </li>
                        <li class='assess1'><span><strong>ASSESSMENT</strong></span>
                        </li>
                        <li class='assess2'><span class='time'>{{newStatus[4].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 4" data-index='3'></div>
                            <span class='stage_name'>Conditional approval</span> &nbsp;<span class='num' ng-if="commentAmount[4]" ng-click="showStatusComment(4)">{{commentAmount[4]}}</span>
                        </li>
                        <li class='assess3'><span class='time'>{{newStatus[5].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 5" data-index='4'></div>
                            <span class='stage_name'>Valuation ordered</span>&nbsp; <span class='num'ng-if="commentAmount[5]" ng-click="showStatusComment(5)">{{commentAmount[5]}}</span>
                        </li>
                        <li class='assess4'><span class='time'>{{newStatus[6].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 6" data-index='5'></div>
                            <span class='stage_name'>Unconditional approval</span>&nbsp; <span class='num'ng-if="commentAmount[6]" ng-click="showStatusComment(6)">{{commentAmount[6]}}</span>
                        </li>
                        <li class='assess5'><span class='time'>{{newStatus[7].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 7" data-index='6'></div>
                            <span class='stage_name'>Docs issued</span>&nbsp; <span class='num' ng-if="commentAmount[7]" ng-click="showStatusComment(7)">{{commentAmount[7]}}</span>
                        </li>
                        <li class='assess6'><span class='time'>{{newStatus[8].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 8" data-index='7'></div>
                            <span class='stage_name'>Signed docs returned</span>&nbsp; <span class='num' ng-if="commentAmount[8]" ng-click="showStatusComment(8)">{{commentAmount[8]}}</span>
                        </li>
                        <li class='assess7'><span class='time'>{{newStatus[9].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 9" data-index='8'></div>
                            <span class='stage_name'>Ready to book</span>&nbsp; <span class='num'ng-if="commentAmount[9]" ng-click="showStatusComment(9)">{{commentAmount[9]}}</span>
                        </li>

                        <li class='sett1'><span><strong>SETTLEMENT</strong></span>
                        </li>
                        <li class='sett2'><span class='time'>{{newStatus[10].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 10" data-index='9'></div>
                            <span class='stage_name'>Settled</span>&nbsp;<span class='num'ng-if="commentAmount[10]" ng-click="showStatusComment(10)">{{commentAmount[10]}}</span>
                        </li>
                        <li class='sett3'><span class='time'>{{newStatus[11].createAt | date:'MM/dd/yyyy h:mma'}}</span>
                            <div class="circle 11" data-index='10'></div>
                            <span class='stage_name'>One month post settlement confirmation</span> &nbsp;<span class='num'ng-if="commentAmount[11]" ng-click="showStatusComment(11)">{{commentAmount[11]}}</span>
                        </li>
                    </ul>
                </div>

                <button class='saveBtn' type="button" name="button">Save</button>

            </div>

            <div class="approval_down_right">
                <div class="document_control">
                    <div class="upload_doc">
                        <span><i class="fa fa-upload fa-lg" aria-hidden="true"></i></span><span class='doc'><strong>UP DOCUMENTS</strong></span>
                    </div>
                    <div class="download_doc">
                        <span><i class="fa fa-download fa-lg" aria-hidden="true"></i></span><span class='doc'><strong>DOWNLOAD DOCUMENTS</strong></span>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="message_part">
                    <div class="message_list">
                        <div class="message_wrap">
                            <div class="scroll_container">
                                <div class="message" ng-repeat="item in comments track by $index">
                                    <div class="commenter">
                                        <!-- <div class="commenter_img">
                                            <img ng-if="item.avatar" ng-src="item.avatar" alt="">
                                            <img ng-if="!item.avatar" ng-src="{{default_img_url}}" alt="">
                                        </div> -->
                                        <div class="commenter_name">
                                            <strong>{{item.username}}</strong>
                                        </div>
                                        <div class="comment_time">
                                            {{item.create_at | date:'dd/MM/yyyy'}} <br>
                                            {{item.create_at | date:'HH:mm:ss'}}
                                        </div>
                                    </div>
                                    <div class="comment">
                                        <!-- <div class="triangle"><i class="fa fa-caret-left fa-3x" aria-hidden="true"></i>
                                        </div> -->
                                        {{item.content}}
                                    </div>
                                    <div class="clear"></div>
                                    <hr>
                                </div>
                            </div>
                        </div>
                        <!--========================  comment input ============================ -->
                        <br>
                        <div class='comment_title'>Leave a comment</div>
                        <div class="leave_message">
                            <!-- <div class="commenter commenter_leave">
                                <div class="commenter_img">
                                    <img ng-if="user.avatar" ng-src="{{user.avatar}}" alt="">
                                    <img ng-if="!user.avatar" ng-src="{{default_img_url}}" alt="">
                                </div>
                            </div> -->
                            <form class="comment_form">
                                <textarea class='comment_input' placeholder="Add a comment..."
                                          ui-tinymce="tinymceOptions" ng-model="comment"></textarea>
                                <button type="reset" class="cancelBtn">Cancel</button>
                                <button type="submit" class="commentBtn" ng-click="makeComment()">Send</button>
                            </form>
                            <div class="clear"></div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="clear"></div>
        </div>

      </div>
      <!-- width_fix end -->
    </div>
    <!-- rigth_part end -->
</div>
<!-- <script src="./assets/js/libs/jquery-3.2.1.min.js"></script>
<script src="./assets/js/libs/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>
-->
<script type="text/javascript" src="../scripts/loan-job-list.js"></script>
</body>
</html>
